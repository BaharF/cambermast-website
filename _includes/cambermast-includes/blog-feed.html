<!-- Blog feed section -->
<div class="blog-feed-section">
    <!-- Check to make sure there are posts -->
    {%- if site.posts.size > 0 -%}
        {%- for post in site.posts -%}
            <!-- Layout must be agile-blog -->
            {%- if post.categories[0] == 'agile-blog' -%}
                <div class="blog-feed-item">
                    <div class="blog-feed-image-div">
                        <!-- Display the post's featured image, otherwise display a default -->
                         {%- if post.featuredImage == "" or post.featuredImage == nil -%}
                            <!-- Display the default image -->
                            <img class="blog-feed-image" src="{{- '/assets/featured-images/blog-feed-placeholder.jpg' | relative_url -}}">
                        {%- else -%}
                            <!-- Display the posts's featured image -->
                            <img class="blog-feed-image" src="{{- post.featuredImage | relative_url }}" alt="{{- post.title -}}">
                        {%- endif -%}
                    </div>
                    <div class="blog-feed-title-div">
                        <a href="{{- post.url | relative_url -}}" class="blog-feed-title">{{- post.title | escape -}}</a>
                    </div>
                    <div class="blog-feed-excerpt-div">
                        <!-- Preview text should be plain text -->
                        {%- assign previewText = post.excerpt -%}
                        {%- assign previewText = previewText | strip_html -%}
                        {%- assign previewText = previewText | escape -%}
                        {%- assign previewText = previewText | lstrip -%}
                        {%- assign previewText = previewText | rstrip -%}
                        {%- assign previewText = previewText | append: "..." -%}
                        {{- previewText -}}
                    </div>
                </div>
            {%- endif -%}
        {%- endfor -%}
    {%- endif -%}
</div>
